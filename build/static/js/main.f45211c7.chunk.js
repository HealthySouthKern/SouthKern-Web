(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{260:function(e,t,n){e.exports=n.p+"static/media/bhc_logo_color_centered.1ae06d0a.png"},267:function(e,t,n){e.exports=n.p+"static/media/bhc_logo_color_splash.9bf5449e.png"},280:function(e,t,n){e.exports=n(603)},285:function(e,t,n){},287:function(e,t,n){},603:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),l=n.n(o),i=(n(285),n(35)),s=n(36),c=n(44),d=n(43),u=n(45),m=n(605),h=n(606),p=(n(286),n(287),n(151),n(30)),f=(n(152),n(87)),b=(n(90),n(33)),g=(n(65),n(19)),_=(n(293),n(277)),y=n(259),k=n.n(y),E=(n(346),"AIzaSyDtipUzH0lqYdn6Nr5SENn_f88zj9E5Xrs"),v={apiKey:function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"getFirebaseAPIToken",value:function(){return E}}]),e}().getFirebaseAPIToken(),authDomain:"southkerntest01.firebaseapp.com",databaseURL:"https://southkerntest01.firebaseio.com",projectId:"southkerntest01",storageBucket:"southkerntest01.appspot.com",messagingSenderId:"726181107283"},w=k.a.initializeApp(v),C=n(260),M=n.n(C),x=w.functions().httpsCallable("addPerformedAction"),S=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleCancel=function(e){console.log(e),n.setState({modalVisible:!1})},n.state={email:"",password:"",recoveryEmail:"",loadingReset:!1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){w.auth().onAuthStateChanged(function(e){e&&this.props&&this.props.history.push("/")})}},{key:"onLoginClicked",value:function(){var e=this,t=this.state.email,n=this.state.password;w.auth().signInWithEmailAndPassword(t,n).then(function(){var t=w.auth().currentUser;t.getIdToken().then(function(n){w.database().ref("southkernUsers/".concat(t.uid)).once("value").then(function(t){var a=t.val();"admin"===a.user_type?(localStorage.setItem("bhc_user",JSON.stringify(a)),localStorage.setItem("bhc_token",n),x({token:n,user_name:a.user_name,action:"logged in",date:Date.now()}).then(function(){}).catch(function(e){console.log(e)}),e.setState({email:"",password:""}),e.props.history.push("/dashboard")):w.auth().signOut().then(function(){console.log("signed out")})})})}).catch(function(e){console.log(e)})}},{key:"handleForgottenPassword",value:function(){this.setState({modalVisible:!0})}},{key:"sendRecoveryEmail",value:function(){var e=this,t=this.state.recoveryEmail;this.setState({loadingReset:!0}),w.auth().sendPasswordResetEmail(t).then(function(){e.setState({loadingReset:!1}),_.a.success("Password recovery email sent successfully!")})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"login_container"},r.a.createElement("img",{className:"login_logo",src:M.a,alt:""}),r.a.createElement(f.a,{title:"Password Recovery",visible:this.state.modalVisible,onCancel:this.handleCancel,footer:r.a.createElement(g.a,{onClick:function(t){return e.handleCancel(t)}},"Cancel")},r.a.createElement("p",{style:{marginBottom:10}},"Email to send recovery form to"),r.a.createElement(b.a,{placeholder:"Email here...",onChange:function(t){return e.setState({recoveryEmail:t.target.value})}}),r.a.createElement(g.a,{loading:this.state.loadingReset,onClick:function(){return e.sendRecoveryEmail()},style:{marginTop:10},type:"primary"},"Send recovery email")),r.a.createElement(p.a,{className:"login_card"},r.a.createElement("div",{className:"text_wrapper"},r.a.createElement(b.a,{className:"login_email",value:this.state.email,placeholder:"Email",type:"email",onChange:function(t){return e.setState({email:t.target.value})}}),r.a.createElement(b.a,{className:"login_password",value:this.state.password,placeholder:"Password",type:"password",onChange:function(t){return e.setState({password:t.target.value})}}),r.a.createElement("a",{className:"login_forgot",onClick:function(){return e.handleForgottenPassword()},href:"#"},"Forgot password"),r.a.createElement(g.a,{className:"login",onClick:function(){return e.onLoginClicked()}},"Login"))),r.a.createElement("style",null,"\n\n.login_container {\n    height: 100%;\n    width: 100%\n    z-index: 0;\n}\n\n.login_card {\n    width: 25%;\n    height: 32%;\n    \n    position: absolute;\n    top: 40%;\n    bottom: 0;\n    left: 0;\n    right: 0;\n\n    margin: auto;\n    #background-color: #754315;\n    border-radius: 10px;\n    z-index: 0;\n}\n\n.login_logo {\n    height: 200px;\n    position: absolute;\n    top: 0;\n    bottom: 40%;\n    left: 0;\n    right: 0;\n\n    margin: auto;\n    z-index: 0;\n}\n\n.text_wrapper {\n    z-index: 0;\n    position: relative;\n    width: 95%;\n    margin: auto;\n}\n\n.login_email {\n    margin: 5% 0 5% 0;\n    z-index: 99;\n    background-color: #754315;\n    color: white;\n}\n\n.login_password {\n    margin: 5% 0 5% 0;\n    z-index: 99;\n    background-color: #754315;\n    color: white;\n\n}\n\n.login {\n    width: 100%;\n    margin: 5% 0 5% 0;\n    z-index: 99;\n}\n\n.login_forgot {\n    float: right;\n    margin-top: 10px;\n    color: #754315;\n}\n\n@media (max-width: 1000px) {\n    .login_card {\n        width: 100%;\n        border-radius: 0;\n        background-color: #754315;\n        height: 55%;\n    }\n    \n    .login_email {\n        color: black;\n        background-color: white;\n        margin: 0 0 10% 0;\n    }\n    \n    .login_password {\n        color: black;\n        background-color: white;\n        margin: 0 0 10% 0;\n    }\n    \n    .login_forgot {\n        color: white;\n        margin-bottom: 5px;\n    }\n    \n    .login {\n        margin: 0 0 10% 0;\n    }\n    \n    .text_wrapper {\n        width: 95%;\n        margin: auto;\n        position: relative;\n    }\n    \n    .login_logo {\n        bottom: 50%;\n    }\n    \n    .login_logo {\n        height: 150px\n    }\n}\n\n"))}}]),t}(a.Component),N=(n(406),n(60)),U=(n(407),n(39)),O=n(265),T=(n(198),n(29)),D=(n(140),n(9)),I=n(47),A=(n(535),n(89)),z="\n\n    .layout_container {\n        height: 100%;\n    }\n    \n    .sider_menu {\n        background-color: #699C45;\n    }\n    \n    .layout_menu {\n        background-color:  #57803A;\n    }\n    \n    .logo_container {\n        height: 25%:\n        width: 100%;\n        text-align: center;\n    }\n    \n    .logo {\n        width: 60%;\n        padding: 5%;\n        margin: auto;\n    }\n    \n    .header_div {\n        margin: auto auto auto 5%;\n        height: 100%;\n                line-height: 35px;\n\n        \n    }\n    \n    .header {\n        font-size: 175%;\n        margin: 0;\n        height: 40%;\n        position: relative;\n    }\n    \n    .subHeader {\n        height: 20%;\n        margin: 0;\n        position: relative;\n    }\n    \n    .ant-layout-sider-zero-width-trigger {\n       background-color: #57803A;\n    }\n    \n    .ant-layout-sider-zero-width-trigger:hover {\n        background-color: #57803A;\n    }\n    \n    .content_div {\n        padding: 24px;\n    }\n    \n    @media (max-width: 1000px) {\n        \n        .content_div {\n            padding: 5px;\n        }\n        \n        .ant-layout-sider {\n          flex: 0 0 95% !important;\n          width: 64px;\n          max-width: 100% !important;\n          min-width: 100% !important;\n        }\n        \n        .ant-layout-sider-collapsed {\n          flex: 0 0 0px !important;\n          width: 0px;\n          max-width: 0px !important;\n          min-width: 0px !important;\n        }\n        \n        .ant-layout-sider-zero-width-trigger {\n          left: 0 !important;\n          float: left !important;\n          z-index: 9999;\n        }\n        \n        .logo {\n            width: 40%;\n        }\n    }\n",j=n(267),R=n.n(j),V=A.a.Header,B=A.a.Content,P=(A.a.Footer,A.a.Sider),Y=JSON.parse(localStorage.getItem("bhc_user"));var W=function(e){return function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(c.a)(this,Object(d.a)(n).call(this,e))).state={collapsed:!1,user:{}},t.handleMenuClick=t.handleMenuClick.bind(Object(I.a)(Object(I.a)(t))),t.displayPageHeader=t.displayPageHeader.bind(Object(I.a)(Object(I.a)(t))),t}return Object(u.a)(n,t),Object(s.a)(n,[{key:"componentWillMount",value:function(){var e=this;null===Y&&this.props.history.push("/"),w.auth().onAuthStateChanged(function(t){t?e.setState({user:t}):e.props.history.push("/")}).bind(this)}},{key:"handleMenuClick",value:function(e){var t=this;switch(console.log(e.key),e.key){case"logout":return void w.auth().signOut().then(function(){localStorage.clear(),t.props.history.push("/")});case"channels":return void this.props.history.push("/channels");case"dashboard":return void this.props.history.push("/dashboard");case"users":return void this.props.history.push("/users");case"settings":return void this.props.history.push("/settings");default:return}}},{key:"displayPageHeader",value:function(){var e=this.props.location.pathname.split("/")[1],t=Y.user_name.charAt(0).toLocaleUpperCase()+Y.user_name.slice(1);switch(e){case"dashboard":return r.a.createElement("div",{className:"header_div"},r.a.createElement("p",{className:"header"},"Dashboard"),r.a.createElement("p",{className:"sub_header"},"BHC SouthKern - ",t));case"channels":return r.a.createElement("div",{className:"header_div"},r.a.createElement("p",{className:"header"},"Channels"),r.a.createElement("p",{className:"sub_header"},"BHC SouthKern - ",t));case"users":return r.a.createElement("div",{className:"header_div"},r.a.createElement("p",{className:"header"},"Users"),r.a.createElement("p",{className:"sub_header"},"BHC SouthKern - ",t));case"settings":return r.a.createElement("div",{className:"header_div"},r.a.createElement("p",{className:"header"},"Settings"),r.a.createElement("p",{className:"sub_header"},"BHC SouthKern - ",t))}}},{key:"render",value:function(){return r.a.createElement(A.a,{className:"layout_container"},r.a.createElement(P,{className:"sider_menu",breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){}},r.a.createElement("div",{className:"logo_container"},r.a.createElement("img",{className:"logo",src:R.a,alt:""})),r.a.createElement(T.a,{className:"layout_menu",onClick:this.handleMenuClick,theme:"dark",mode:"inline"},r.a.createElement(T.a.Item,{key:"dashboard"},r.a.createElement(D.a,{type:"line-chart"}),r.a.createElement("span",{className:"nav-text"},"Dashboard")),r.a.createElement(T.a.Item,{key:"channels"},r.a.createElement(D.a,{type:"notification"}),r.a.createElement("span",{className:"nav-text"},"Channels")),r.a.createElement(T.a.Item,{key:"users"},r.a.createElement(D.a,{type:"user"}),r.a.createElement("span",{className:"nav-text"},"Users")),r.a.createElement(T.a.Item,{key:"settings"},r.a.createElement(D.a,{type:"setting"}),r.a.createElement("span",{className:"nav-text"},"Settings")),r.a.createElement(T.a.Item,{key:"logout"},r.a.createElement(D.a,{type:"logout"}),r.a.createElement("span",{className:"nav-text"},"Log out")))),r.a.createElement(A.a,null,r.a.createElement(V,{style:{background:"#fff",padding:0}},this.displayPageHeader()),r.a.createElement(B,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"content_div",style:{minHeight:360}},r.a.createElement(e,Object.assign({user:this.state.user},this.props))))),r.a.createElement("style",null,z))}}]),n}(a.Component)},L=n(46),F=n.n(L),H=function(e){var t=e.createdAt,n=e.text,a=F()(t,"x").format("MMMM Do YYYY, h:mm a");return r.a.createElement("div",{style:{backgroundColor:"#cc202d",borderRadius:10,padding:10,display:"flex",flexDirection:"row",marginBottom:"2%"}},r.a.createElement("div",null,r.a.createElement(D.a,{style:{color:"white",fontSize:30},type:"message"})),r.a.createElement("div",{style:{marginLeft:10,width:"100%"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%"}},r.a.createElement("p",{style:{marginBottom:0,color:"white",fontSize:16,fontWeight:"bold"}},"Status Update"),r.a.createElement("p",{style:{marginBottom:0,color:"white",marginLeft:10,fontSize:16}},a)),r.a.createElement("p",{style:{color:"white",margin:0}},n)))},K=function(e){var t=e.user_name,n=e.action,a=e.date,o=F()(a,"x").format("MMMM Do YYYY, h:mm a"),l=t.charAt(0).toLocaleUpperCase()+t.slice(1),i="".concat(l," ").concat(n," on ").concat(o);return r.a.createElement("div",{className:"history_container"},r.a.createElement("div",{className:"name_date_container"},r.a.createElement("p",{className:"history"},i)),r.a.createElement("style",null,"\n\n    .history_container {\n        margin: 3% auto;\n        border-style: none solid none solid;\n        border-width: 0.5px;\n        padding: 5px;\n        background-color: #754315;\n        border-radius: 5px;\n    }\n    \n    .name_date_container {\n        \n    }\n    \n    .history {\n        color: white;\n        margin: auto;\n    }\n    \n    .history_date {\n        margin: auto;\n        color: white;\n    }\n    \n    .action_text {\n        color: white;\n\n    }\n    \n    hr {\n        display: block;\n        height: 1px;\n        border: 0;\n        border-top: 1px solid #ccc;\n        margin: 0.5em 0;\n        padding: 0;\n    }\n\n"))},G=W(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={openChannels:[],groupChannels:[],userList:[],historyItems:[],user:{},chartData:{},statusUpdates:[],statusText:"",showChart:!1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleStatusPost",value:function(){var e=this.state.statusText;w.database().ref("statusUpdates").push({text:e,createdAt:Date.now()}),this.setState({statusText:""})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.user){var n=e.user,a={},r={},o=[],l=[],i=w.functions().httpsCallable("fetchOpenChannels"),s=w.functions().httpsCallable("fetchGroupChannels"),c=w.functions().httpsCallable("fetchSendbirdStatisticsData");w.database().ref("analytics/users").once("value").then(function(e){Object.keys(e.val()).map(function(t,n){o[n]=e.val()[t]});for(var n=[],l=0;l<30;l++)n[l]=l+1;a={labels:n,datasets:[{label:"Users",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]},r={title:{display:!0,text:"User Count over the Past Thirty Days"},responsive:!0,maintainAspectRatio:!1,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,offsetGridLines:!1,legend:!1,multiTooltipTemplate:"<%= datasetLabel %> - <%= value %>"},t.setState({chartData:a,chartOptions:r,showChart:!0})}),w.database().ref("analytics/adminHistory").once("value").then(function(e){Object.keys(e.val()).map(function(t,n){l[n]=e.val()[t]}),t.setState({historyItems:l.reverse()})}),w.database().ref("statusUpdates").once("value").then(function(e){var n=[];Object.keys(e.val()).map(function(t,a){n.push(e.val()[t])}),t.setState({statusUpdates:n})}),n.getIdToken().then(function(e){i({token:e}).then(function(e){console.log(e.data[0].channels),t.setState({openChannels:e.data[0].channels})}),s({token:e}).then(function(e){console.log(e.data[0].channels),t.setState({groupChannels:e.data[0].channels})}),c({token:e}).then(function(e){console.log(e),t.setState({sendbirdStatistics:e.data})}),w.database().ref("southkernUsers").once("value").then(function(e){var n=[];Object.keys(e.val()).map(function(t,a){n[a]=e.val()[t]}),t.setState({userList:n})})})}else this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.state,n=t.groupChannels,a=t.openChannels,o=t.userList,l=t.sendbirdStatistics,i=t.chartData,s=t.chartOptions,c=t.statusUpdates,d=t.showChart,u=t.historyItems;return r.a.createElement("div",null,r.a.createElement(N.a,{style:{whiteSpace:"nowrap",marginBottom:"2%"}},r.a.createElement(U.a,{className:"grid_container",xs:{span:1},lg:{span:1},style:{width:"100%",marginLeft:"auto",marginRight:"auto",marginTop:"-3%",height:300}},r.a.createElement(p.a,{className:"grid_box",style:{overflowX:"scroll",overflowY:"hidden"},bodyStyle:{width:"100%"}},d?r.a.createElement("div",{className:"chart_div"},r.a.createElement(O.a,{data:i,options:s,height:0,width:"100%",style:{position:"absolute",width:"100%",height:"90%",padding:"1%"}})):r.a.createElement("div",null)))),r.a.createElement(N.a,{className:"stats_history_wrapper",style:{marginBottom:"2%"}},r.a.createElement(U.a,{className:"grid_container",xs:{span:1},lg:{span:1}},r.a.createElement(p.a,{className:"grid_box",style:{overflowX:"hidden",overflowY:"scroll"}},r.a.createElement("h3",null,"Quick Stats"),r.a.createElement("hr",null),r.a.createElement("div",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Monthly Active Users")," ",r.a.createElement("p",{className:"data"},l?l.mau:0)),r.a.createElement("hr",null),r.a.createElement("div",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Daily Active users")," ",r.a.createElement("p",{className:"data"},l?l.dau:0)),r.a.createElement("hr",null),r.a.createElement("div",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Currently Online Users")," ",r.a.createElement("p",{className:"data"},l?l.ccu:0)),r.a.createElement("hr",null),r.a.createElement("div",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Total Current Users")," ",r.a.createElement("p",{className:"data"},o.length)),r.a.createElement("hr",null),r.a.createElement("span",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Total Open Channels")," ",r.a.createElement("p",{className:"data"},a.length)),r.a.createElement("hr",null),r.a.createElement("span",{className:"data_wrapper"},r.a.createElement("p",{className:"data_title"},"Total Group Channels")," ",r.a.createElement("p",{className:"data"},n.length)),r.a.createElement("hr",null))),r.a.createElement(U.a,{className:"grid_container",xs:{span:1,offset:1}},r.a.createElement(p.a,{className:"grid_box",style:{overflowX:"hidden",overflowY:"scroll"}},r.a.createElement(b.a,{value:this.state.statusText,style:{marginBottom:"2%"},onChange:function(t){e.setState({statusText:t.target.value})},placeholder:"What is going on in the community?"}),r.a.createElement(g.a,{style:{marginBottom:"2%"},onClick:function(){return e.handleStatusPost()}},"Post Status Update"),c?c.map(function(e){return r.a.createElement(H,{createdAt:e.createdAt,text:e.text})}):r.a.createElement("div",null)))),r.a.createElement(N.a,{className:"stats_history_wrapper"},r.a.createElement(U.a,{className:"grid_container",xs:{span:1}},r.a.createElement(p.a,{className:"grid_box",style:{overflowY:"scroll",overflowX:"hidden"}},u.map(function(e){return r.a.createElement(K,{user_name:e.user_name,action:e.action,date:e.date})})))),r.a.createElement("style",null,"\n\n    .grid_container {\n        width: 47.9%;\n        height: 250px;\n        background-color: white;\n\n    }\n    \n    .grid_box {\n        width: 100%;\n        height: 100%;\n        background-color: white;\n        text-align: left;\n    }\n    \n    .ant-card-body {\n        height: 100%;\n        width: 100%;\n    }\n    \n    .data_wrapper {\n        display: flex;\n        flex-direction: row;\n        width: 70%;\n        margin-top: auto;\n        \n    }\n    \n    .data_title {\n        margin: 0;\n    }\n    \n    .data {\n        position: absolute;\n        left: 90%;\n        right: 5%;\n        text-align: right;\n        margin: 0;\n    }\n    \n    hr {\n        display: block;\n        height: 1px;\n        border: 0;\n        border-top: 1px solid #ccc;\n        margin: 0.5em 0;\n        padding: 0;\n    }\n    \n    stats_history_wrapper {\n        margin-top: 3%;\n        display: flex;\n        flex-direction: row ;\n    }\n    \n    .chart_div {\n            width: 100%;\n            height: 100%;\n    }\n    \n    @media (max-width: 1000px) {\n        stats_history_wrapper {\n            flex-direction: column;\n        }\n        \n        .grid_container {\n            width: 100%;\n            margin: auto;\n            margin-bottom: 2%;\n        }\n        \n        .chart_div {\n            width: 800px;\n        }\n        \n        .card_wrapper {\n            width: 800px;\n        }\n    }\n"))}}]),t}(a.Component)),X=(n(196),n(64)),q=(n(257),n(88)),J=(n(251),n(42)),Q=(n(202),n(103)),$={groupColumns:[{title:"Name",dataIndex:"name",key:"name"},{title:"Participants",className:"table_participants_column",dataIndex:"member_count",key:"member_count"},{title:"Date Created",className:"table_created_column",render:function(e,t,n){var a=F.a.unix(e.created_at).format("MMMM Do YYYY");return r.a.createElement("div",null,a)},key:"created_at"}],openColumns:[{title:"Name",dataIndex:"name",key:"name"},{title:"Participants",dataIndex:"participant_count",key:"participant_count"},{title:"Date Created",render:function(e,t,n){var a=F.a.unix(e.created_at).format("MMMM Do YYYY");return r.a.createElement("div",null,a)},key:"created_at"}]},Z=Q.a.TabPane,ee=w.functions().httpsCallable("fetchOpenChannels"),te=w.functions().httpsCallable("fetchGroupChannels"),ne=w.functions().httpsCallable("fetchChannelMembers"),ae=w.functions().httpsCallable("fetchBannedAndMutedUsers"),re=w.functions().httpsCallable("banOrMuteUser"),oe=w.functions().httpsCallable("unBanOrUnMuteUser"),le=w.functions().httpsCallable("freezeChannel"),ie=w.functions().httpsCallable("deleteChannel"),se=w.functions().httpsCallable("addPerformedAction");function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(n)if(e){for(var a=0;a<e.length;a++)if(null!=e[a].user){if(e[a].user.user_id===n.user_id)return!0}else if(e[a].user_id===n.user_id)return!0}else if(t)for(var r=0;r<t.length;r++)if(null!=t[r].user){if(t[r].user.user_id===n.user_id)return!0}else if(t[r].user_id===n.user_id)return!0;return!1}function de(e,t,n){for(var a=0;a<e.length;a++)if(e[a].user_id===t.user_id){e.splice(a,1);break}n()}function ue(e,t){var n=null;return function(){var a=this,r=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(a,r)},t)}}var me=W(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).tableActionMenu=function(e){return console.log(e),r.a.createElement(T.a,null,r.a.createElement(T.a.Item,{style:{backgroundColor:e.freeze?" #85c1e9 ":"white"}},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",style:{color:e.freeze?"white":""},onClick:function(){le({token:n.state.firebaseToken,channel:e.channel_url,channelType:e.member_count?"group_channels":"open_channels",freeze:!e.freeze}).then(function(t){return e.freeze=!e.freeze,se({token:n.state.firebaseToken,user_name:n.state.currentUserName,date:Date.now(),action:"".concat(e.freeze?"froze":"defrosted"," channel ").concat(e.name)}),t}).catch(function(e){console.log(e)})}},e.freeze?"Defrost channel":"Freeze channel")),r.a.createElement(T.a.Item,null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",onClick:function(){n.setState({deleteModalVisible:!0,recordToDelete:e})}},"Delete channel")))},n.expandedOpenRowRender=function(e,t,a,o){var l=e.participants,i=!1,s=[{title:"Email",className:"email_column",dataIndex:"user_id",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,t)}}},{title:"Username",dataIndex:"nickname",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,t)}}},{title:"Status",className:"status_column",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,n.is_online?"Online":"Offline")}},key:"is_online"},{title:"Last Online",className:"last_online_column",render:function(t,n,a){e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n));var o=n.is_online?"Now":F()(n.last_seen_at).format("MMMM Do YYYY");return{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,o)}},key:"last_online"},{title:"Actions",dataIndex:"operation",key:"operation",render:function(t,a,o){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,a)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",{style:{width:"100%",float:"left"}},r.a.createElement(J.a,{className:"banUser",style:{whiteSpace:"nowrap"},key:"banUser",checked:e.bannedMembers?ce(e.bannedMembers,null,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"ban")}},"Banned"),r.a.createElement(J.a,{className:"muteUser",style:{margin:0,whiteSpace:"nowrap"},key:"muteUser",checked:e.mutedMembers?ce(null,e.mutedMembers,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"mute")}},"Muted"))}}}],c=[{title:"Nickname",dataIndex:"user_name",key:"user_name"},{title:"Actions",dataIndex:"operation",key:"operation",render:function(t,a,o){return r.a.createElement("div",{style:{width:"100%",float:"left"}},r.a.createElement(J.a,{className:"banUser",style:{whiteSpace:"nowrap"},key:"banUser",checked:e.bannedMembers?ce(e.bannedMembers,null,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"ban")}},"Banned"),r.a.createElement(J.a,{className:"muteUser",style:{margin:0,whiteSpace:"nowrap"},key:"muteUser",checked:e.mutedMembers?ce(null,e.mutedMembers,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"mute")}},"Muted"))}}];return r.a.createElement(q.a,{size:"middle",dataSource:l,columns:n.state.mobile?c:s})},n.expandedGroupRowRender=function(e,t,a,o){console.log(e),console.log(t),console.log(a);var l=e.members,i=!1,s=[{title:"Email",className:"email_column",dataIndex:"user_id",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,t)}}},{title:"Username",dataIndex:"nickname",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,t)}}},{title:"Status",className:"status_column",render:function(t,n,a){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,n.is_online?"Online":"Offline")}},key:"is_online"},{title:"Last Online",className:"last_online_column",render:function(t,n,a){e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,n));var o=n.is_online?"Now":F()(n.last_seen_at).format("MMMM Do YYYY");return{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",null,o)}},key:"last_online"},{title:"Actions",dataIndex:"operation",key:"operation",render:function(t,a,o){return e.bannedMembers&&(i=ce(e.bannedMembers,e.mutedMembers,a)),{props:{style:{background:i?"#ddd":"#fff"}},children:r.a.createElement("div",{style:{width:"100%",float:"left"}},r.a.createElement(J.a,{className:"banUser",style:{whiteSpace:"nowrap"},key:"banUser",checked:e.bannedMembers?ce(e.bannedMembers,null,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"ban")}},"Banned"),r.a.createElement(J.a,{className:"muteUser",style:{margin:0,whiteSpace:"nowrap"},key:"muteUser",checked:e.mutedMembers?ce(null,e.mutedMembers,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"mute")}},"Muted"))}}}],c=[{title:"Username",dataIndex:"nickname",key:"nickname"},{title:"Actions",dataIndex:"operation",key:"operation",render:function(t,a,o){return r.a.createElement("div",{style:{width:"100%",float:"left"}},r.a.createElement(J.a,{className:"banUser",style:{whiteSpace:"nowrap"},key:"banUser",checked:e.bannedMembers?ce(e.bannedMembers,null,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"ban")}},"Banned"),r.a.createElement(J.a,{className:"muteUser",style:{margin:0,whiteSpace:"nowrap"},key:"muteUser",checked:e.mutedMembers?ce(null,e.mutedMembers,a):null,onChange:function(t){return n.handleUserAction(t,a,e,"mute")}},"Muted"))}}];return r.a.createElement(q.a,{size:"middle",loading:n.state.loadingSubTable,rowKey:function(e){return e.uid},dataSource:l,expandIconAsCell:!1,columns:n.state.mobile?c:s})},n.handleDeleteModalOk=function(e,t){for(var a=n.state,r=a.groupChannels,o=a.openChannels,l=!!t.member_count,i=l?r:o,s=0;s<i.length;s++)i[s]===t&&i.splice(s,1);ie({token:n.state.firebaseToken,channel:t.channel_url,channelType:t.member_count?"group_channels":"open_channels"}).then(function(e){return se({token:n.state.firebaseToken,user_name:n.state.currentUserName,date:Date.now(),action:"deleted channel ".concat(t.name)}),e.data}),l?n.setState({deleteModalVisible:!1,groupChannels:i}):n.setState({deleteModalVisible:!1,openChannels:i})},n.handleDeleteModalCancel=function(e){n.setState({deleteModalVisible:!1})},n.state={openChannels:[],groupChannels:[],currentTab:"openChannels",firebaseToken:"",isExpanded:!1,loadingTable:!0,loadingSubTable:!0,mobile:!1,deleteModalVisible:!1,recordToDelete:null},n.handleWindowResize=n.handleWindowResize.bind(Object(I.a)(Object(I.a)(n))),""!==$.openColumns[$.openColumns.length-1].title&&($.groupColumns.push({title:"",className:"table_actions",render:function(e,t,a){return r.a.createElement(X.a,{trigger:["click"],overlay:function(){return n.tableActionMenu(t)}},r.a.createElement(D.a,{className:"more_icon",type:"ellipsis"}))}}),$.openColumns.push({title:"",className:"table_actions",render:function(e,t,a){return r.a.createElement(X.a,{trigger:["click"],overlay:function(){return n.tableActionMenu(t)}},r.a.createElement(D.a,{className:"more_icon",type:"ellipsis"}))}})),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"customExpandIcon",value:function(e){return e.expanded?r.a.createElement("a",{style:{color:"black"},onClick:function(t){e.onExpand(e.record,t)}},r.a.createElement(D.a,{type:"minus"})):r.a.createElement("a",{style:{color:"black"},onClick:function(t){e.onExpand(e.record,t)}},r.a.createElement(D.a,{type:"plus"}))}},{key:"handleWindowResize",value:function(){window.innerWidth<=760?this.setState({mobile:!0}):this.setState({mobile:!1})}},{key:"handleTabChange",value:function(e){this.setState({currentTab:e})}},{key:"handleUserAction",value:function(e,t,n,a){var r=this;if(n.firebaseToken)if(e.target.checked)switch(a){case"ban":n.bannedMembers.push(t),this.forceUpdate(),re({token:n.firebaseToken,userID:t.user_id,channelType:n.members?"group_channels":"open_channels",channel:n.channel_url,action:"ban"}).then(function(e){se({token:r.state.firebaseToken,user_name:r.state.currentUserName,date:Date.now(),action:"banned ".concat(t.nickname," from ").concat(n.name)})});break;case"mute":n.mutedMembers.push(t),this.forceUpdate(),re({token:n.firebaseToken,userID:t.user_id,channelType:n.members?"group_channels":"open_channels",channel:n.channel_url,action:"mute"}).then(function(e){se({token:r.state.firebaseToken,user_name:r.state.currentUserName,date:Date.now(),action:"muted ".concat(t.nickname," in ").concat(n.name)})})}else switch(a){case"ban":de(n.bannedMembers,t,function(){r.forceUpdate()}),oe({token:n.firebaseToken,userID:t.user_id,channelType:n.members?"group_channels":"open_channels",channel:n.channel_url,action:"ban"}).then(function(){se({token:r.state.firebaseToken,user_name:r.state.currentUserName,date:Date.now(),action:"unbanned ".concat(t.nickname," from ").concat(n.name)})}).catch(function(e){console.log(e)});break;case"mute":de(n.mutedMembers,t,function(){r.forceUpdate()}),oe({token:n.firebaseToken,userID:t.user_id,channelType:n.members?"group_channels":"open_channels",channel:n.channel_url,action:"mute"}).then(function(e){se({token:r.state.firebaseToken,user_name:r.state.currentUserName,date:Date.now(),action:"unmuted ".concat(t.nickname," in ").concat(n.name)})}).catch(function(e){console.log(e)})}}},{key:"handleRowExpand",value:function(e,t){var n=this,a=!!t.member_count;if(e){this.setState({loadingSubTable:!0});var r=ne({token:this.state.firebaseToken,channel:t.channel_url,isGroupChannel:a}).then(function(e){a?t.members=e.data[0].members:t.participants=e.data[0].participants,t.firebaseToken=n.state.firebaseToken}),o=ae({token:this.state.firebaseToken,channel:t.channel_url,channelType:a?"group_channels":"open_channels",action:"ban"}).then(function(e){return t.bannedMembers=e.data.banned_list,e.data.banned_list}).catch(function(e){console.log(e)}),l=ae({token:this.state.firebaseToken,channel:t.channel_url,channelType:a?"group_channels":"open_channels",action:"mute"}).then(function(e){console.log(e.data.muted_list),t.mutedMembers=e.data.muted_list}).catch(function(e){console.log(e)});Promise.all([r,o,l].map(function(e){return e.catch(function(e){return e})})).then(function(r){var o=r[1];if(a&&t)for(var l in o)t.members.push(o[l].user);else for(var i in o)t.participants.push(o[i].user);n.setState({isExpanded:e,loadingSubTable:!1})}).catch(function(e){console.log(e)})}}},{key:"componentWillMount",value:function(){window.innerWidth<=760&&this.setState({mobile:!0}),window.addEventListener("resize",ue(this.handleWindowResize,500))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.user){var n=e.user;n.getIdToken().then(function(e){ee({token:e}).then(function(a){t.setState({openChannels:a.data[0].channels,firebaseToken:e,currentUserName:n.displayName})}),te({token:e}).then(function(e){t.setState({groupChannels:e.data[0].channels,loadingTable:!1})})})}else this.props.history.push("/")}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",ue(this.handleWindowResize,500))}},{key:"render",value:function(){var e=this,t=this.state,n=t.groupChannels,a=t.openChannels,o=t.loadingTable,l=t.deleteModalVisible,i=t.recordToDelete;return r.a.createElement("div",null,r.a.createElement(f.a,{title:"Confirm Channel Deletion",visible:l,onOk:this.handleDeleteModalOk,onCancel:this.handleDeleteModalCancel,footer:r.a.createElement("span",{style:{whiteSpace:"nowrap"}},r.a.createElement(g.a,{onClick:function(t){return e.handleDeleteModalCancel(t)}},"Cancel"),r.a.createElement(g.a,{onClick:function(t){return e.handleDeleteModalOk(t,i)},type:"danger"},"Delete"))},r.a.createElement("p",null,"Are you sure you want to delete ",i?i.name:"this channel","?")),r.a.createElement(Q.a,{style:{margin:0,padding:0,width:"100%"},activeKey:this.state.currentTab,onChange:function(t){return e.handleTabChange(t)}},r.a.createElement(Z,{tab:"Open Channels",key:"openChannels"},r.a.createElement(q.a,{expandIcon:function(t){return e.customExpandIcon(t)},loading:o,dataSource:a,onExpand:function(t,n){return e.handleRowExpand(t,n)},expandedRowRender:function(t){return e.expandedOpenRowRender(t)},columns:this.state.mobile?$.groupColumnsMobile:$.openColumns,rowKey:function(e){return e.channel_url}})),r.a.createElement(Z,{tab:"Group Channels",key:"groupChannels"},r.a.createElement(q.a,{expandIcon:function(t){return e.customExpandIcon(t)},loading:o,dataSource:n,onExpand:function(t,n){return e.handleRowExpand(t,n)},expandedRowRender:function(t,n,a){return e.expandedGroupRowRender(t,n,a)},columns:this.state.mobile?$.groupColumnsMobile:$.groupColumns,rowKey:function(e){return e.channel_url}}))),r.a.createElement("style",null,"\n    .ant-pagination {\n        margin: 16px 16px 0 0 !important;\n    }\n    \n    .more_icon {\n        -webkit-transform: rotate(90deg);\n        -moz-transform: rotate(90deg);\n        -o-transform: rotate(90deg);\n        -ms-transform: rotate(90deg);\n        transform: rotate(90deg);\n        \n        cursor: pointer;\n        font-size: 25px;\n    }\n    \n    @media (max-width: 1000px) {\n        .email_column {\n            display: hidden !important;\n        }\n        \n        .status_column {\n            display: hidden !important;\n        }\n        \n        .last_online_column {\n            display: hidden !important;\n        }\n        \n        .table_created_column {\n            display: hidden !important;\n        }\n        \n        .table_participants_column {\n            display: hidden !important;\n        }\n    }\n"))}}]),t}(a.Component)),he=(n(197),n(41)),pe=(n(258),n(27)),fe=w.functions().httpsCallable("banOrUnbanUserFromApp"),be=w.functions().httpsCallable("updateUserPasswordAndName"),ge=w.functions().httpsCallable("deleteUserFromFirebaseAndSendbird"),_e=w.functions().httpsCallable("addPerformedAction");function ye(e){if(e.uid)return e.uid;w.database().ref("southkernUsers").once("value").then(function(t){Object.keys(t.val()).map(function(n,a){if(t.val()[n].sendbirdToken===e.sendbirdToken)return n})})}var ke=W(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).tableActionMenu=function(e){return r.a.createElement(T.a,null,r.a.createElement(T.a.Item,null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",onClick:function(){n.setState({editModalVisible:!0,recordToEdit:e})}},"Edit")),r.a.createElement(T.a.Item,null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",onClick:function(){n.handleUserBan(e)}},e.is_banned?"Unban":"Ban")),r.a.createElement(T.a.Item,null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",onClick:function(){n.setState({deleteModalVisible:!0,recordToDelete:e})}},"Delete")))},n.userColumns=[{title:"Email",dataIndex:"user_id",key:"user_id"},{title:"Name",dataIndex:"user_name",key:"user_name"},{title:"Status",className:"status_column",render:function(e,t,n){return r.a.createElement("div",null,t.is_online?"Online":"Offline")},key:"is_online"},{title:"Last Online",className:"last_online_column",render:function(e,t,n){var a=t.is_online?"Now":F()(t.last_seen_at).format("MMMM Do YYYY");return r.a.createElement("div",null,a)},key:"last_online"},{title:"",className:"table_actions",render:function(e,t,a){return r.a.createElement(X.a,{trigger:["click"],overlay:function(){return n.tableActionMenu(t)}},r.a.createElement(D.a,{className:"more_icon",type:"ellipsis"}))}}],n.userColumnsMobile=[n.userColumns[1],n.userColumns[4]],n.handleDeleteModalOk=function(e,t){for(var a=n.state.users,r=0;r<a.length;r++)a[r]===t&&a.splice(r,1);ge({token:n.state.firebaseToken,email:t.user_id,user_uid:ye(t)}).then(function(){_e({token:n.state.firebaseToken,user_name:n.state.currentUserName,date:Date.now(),action:"deleted ".concat(t.user_name)})}),w.database().ref("southkernUsers/".concat(ye(t))).remove(),n.setState({deleteModalVisible:!1,users:a})},n.handleModalCancel=function(e,t){switch(t){case"delete":n.setState({deleteModalVisible:!1});break;case"edit":n.setState({editModalVisible:!1});break;default:return}},n.state={users:[],originalUsers:[],mobile:!1,recordToDelete:null,recordToEdit:null,deleteModalVisible:!1,editModalVisible:!1,firebaseToken:null},n.handleWindowResize=n.handleWindowResize.bind(Object(I.a)(Object(I.a)(n))),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleUserCreate",value:function(e){this.setState({recordToEdit:null,editModalVisible:!0})}},{key:"handleUserBan",value:function(e){var t=this;w.database().ref("bannedUsers").once("value").then(function(n){var a="ban";t.props.user&&t.props.user.getIdToken().then(function(r){null!=n.val()&&(a=Object.keys(n.val()).includes(ye(e))?"unban":"ban"),w.database().ref("southkernUsers/".concat(ye(e),"/is_banned")).set("ban"===a),e.is_banned="ban"===a,fe({action:a,token:r,user_uid:ye(e)}).then(function(){_e({token:t.state.firebaseToken,user_name:t.state.currentUserName,date:Date.now(),action:"".concat("ban"===a?"banned":"unbanned"," ").concat(e.user_name)})}),t.forceUpdate()})})}},{key:"handleEditModalOk",value:function(e,t){var n=this;if(this.props.form){var a=this.props.form.getFieldsValue();null!=t?(null!=a.user_password&&be({name:t.user_name,user_uid:ye(t),password:a.user_password,token:this.state.firebaseToken}),a.user_password=null,Object.keys(a).map(function(e,n){t[e]=a[e]}),w.database().ref("southkernUsers/".concat(ye(t))).set(t).then(function(){_e({token:n.state.firebaseToken,user_name:n.state.currentUserName,date:Date.now(),action:"edited ".concat(t.user_name)})}),this.props.form.resetFields(),this.setState({editModalVisible:!1})):this.props.form.validateFields(function(e){e||w.auth().createUserWithEmailAndPassword(a.user_id,a.user_password).then(function(e){console.log(e.user.uid),be({token:n.state.firebaseToken,password:a.user_password,name:a.user_name,user_uid:e.user.uid}).then(function(){_e({token:n.state.firebaseToken,user_name:n.state.currentUserName,date:Date.now(),action:"created ".concat(t.user_name)})}),a.user_password=null,a.uid=e.user.uid,w.database().ref("southkernUsers/".concat(e.user.uid)).set(a),n.props.form.resetFields(),n.setState({editModalVisible:!1})})})}else this.setState({editModalVisible:!1}),console.log("form props missing")}},{key:"handleWindowResize",value:function(){window.innerWidth<=760?this.setState({mobile:!0}):this.setState({mobile:!1})}},{key:"handleSearch",value:function(e){var t=e.target.value,n=this.state,a=n.users,r=n.originalUsers;if(""!==t){var o=a.filter(function(e){return Object.keys(e).some(function(n){return!!e[n].includes&&e[n].includes(t)})});this.setState({users:o})}else this.setState({users:r})}},{key:"componentWillMount",value:function(){window.innerWidth<=760&&this.setState({mobile:!0}),window.addEventListener("resize",function(e,t){var n=null;return function(){var a=this,r=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(a,r)},t)}}(this.handleWindowResize,500))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.user){var n=e.user;n.getIdToken().then(function(e){w.database().ref("southkernUsers").once("value").then(function(a){var r=[];Object.keys(a.val()).map(function(e,t){r[t]=a.val()[e]}),t.setState({users:r,originalUsers:r,firebaseToken:e,currentUserName:n.displayName})})})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,a=t.loadingTable,o=t.recordToDelete,l=t.recordToEdit,i=t.deleteModalVisible,s=t.editModalVisible,c=(t.createModalVisible,this.props.form.getFieldDecorator);return r.a.createElement("div",null,r.a.createElement(f.a,{title:"Confirm User Deletion",visible:i,onCancel:function(t){return e.handleModalCancel(t,"delete")},footer:r.a.createElement("span",{style:{whiteSpace:"nowrap"}},r.a.createElement(g.a,{onClick:function(t){return e.handleModalCancel(t,"delete")}},"Cancel"),r.a.createElement(g.a,{onClick:function(t){return e.handleDeleteModalOk(t,o)},type:"danger"},"Delete"))},r.a.createElement("p",null,"Are you sure you want to delete ",o?o.user_name?o.user_name:"this user":null,"?")),r.a.createElement(f.a,{title:"".concat(l?"Edit":"Create"," ").concat(l&&l.user_name?l.user_name:"User"),visible:s,onCancel:function(t){return e.handleModalCancel(t,"edit")},footer:r.a.createElement("span",{style:{whiteSpace:"nowrap"}},r.a.createElement(g.a,{onClick:function(t){return e.handleModalCancel(t,"edit")}},"Cancel"),r.a.createElement(g.a,{onClick:function(t){return e.handleEditModalOk(t,l)},type:"primary"},l?"Apply":"Create"))},r.a.createElement(pe.a,{layout:"vertical"},r.a.createElement(pe.a.Item,null,c("user_id",{initialValue:l?l.user_id:null,rules:[{required:!0,message:"Please enter a email"}]})(r.a.createElement(b.a,{prefix:r.a.createElement(D.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email"}))),r.a.createElement(pe.a.Item,null,c("user_name",{initialValue:l?l.user_name:null,rules:[{required:!0,message:"Please enter a username."}]})(r.a.createElement(b.a,{prefix:r.a.createElement(D.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),r.a.createElement(pe.a.Item,null,c("user_password",{initialValue:null,rules:[{required:!0,message:"Please enter a password."},{min:6,message:"Password must be at least six characters long"}]})(r.a.createElement(b.a,{type:"password",prefix:r.a.createElement(D.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Password"}))),r.a.createElement(pe.a.Item,null,c("user_organization",{initialValue:l?l.user_organization:null})(r.a.createElement(b.a,{placeholder:"User Organization"}))),r.a.createElement(pe.a.Item,null,c("user_position",{initialValue:l?l.user_position:null})(r.a.createElement(b.a,{placeholder:"User Position"}))),r.a.createElement(pe.a.Item,null,c("user_type",{initialValue:l?l.user_type:"resident"})(r.a.createElement(he.a,{firstActiveValue:l?l.user_type:"resident",placeholder:"User role"},r.a.createElement(he.a.Option,{value:"admin"},"Administrator"),r.a.createElement(he.a.Option,{value:"organization"},"Organization"),r.a.createElement(he.a.Option,{value:"resident"},"Resident")))))),r.a.createElement("div",{style:{whiteSpace:this.state.mobile?"":"nowrap"}},r.a.createElement(b.a.Search,{onChange:function(t){return e.handleSearch(t)},type:"search",placeholder:"Search for people",style:{width:"75%"}}),r.a.createElement(g.a,{onClick:function(t){return e.handleUserCreate(t)},style:{zIndex:999,marginBottom:10,marginLeft:this.state.mobile?0:10,marginTop:this.state.mobile?10:0},size:"medium",type:"primary",icon:"user-add"},"Create user")),r.a.createElement(q.a,{rowClassName:function(e,t){return e.is_banned?"banned":"not_banned"},loading:a,dataSource:n,columns:this.state.mobile?this.userColumnsMobile:this.userColumns}),r.a.createElement("style",null,"\n    .more_icon {\n        -webkit-transform: rotate(90deg);\n        -moz-transform: rotate(90deg);\n        -o-transform: rotate(90deg);\n        -ms-transform: rotate(90deg);\n        transform: rotate(90deg);\n        \n        cursor: pointer;\n        font-size: 25px;\n    }\n    \n    .banned {\n        background-color: #ddd;\n    }\n    \n"))}}]),t}(a.Component)),Ee=pe.a.create({name:"edit_user"})(ke),ve=(n(599),n(201)),we=he.a.Option,Ce=w.functions().httpsCallable("fetchOrUpdateSendbirdSettings"),Me={labelCol:{span:8},wrapperCol:{span:5,offset:1}},xe=W(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={sendbirdSettings:null,flag:!0},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleSettingsSubmit",value:function(){if(this.props.form){var e=this.props.form.getFieldsValue();switch(e.profanity_filter.type){case"Do nothing":e.profanity_filter.type=0;break;case"Replace with asterisks":e.profanity_filter.type=1;break;case"Block messages":e.profanity_filter.type=2}switch(e.domain_filter.type){case"Do nothing":e.domain_filter.type=0;break;case"Allow only these domains":e.domain_filter.type=1;break;case"Block these domains":e.domain_filter.type=2}switch(e.profanity_triggered_moderation.action){case"Do nothing":e.profanity_triggered_moderation.action=0;break;case"Mute user":e.profanity_triggered_moderation.action=1;break;case"Kick user from channel":e.profanity_triggered_moderation.action=2;break;case"Ban user from channel":e.profanity_triggered_moderation.action=3}e.domain_filter.domains=e.domain_filter.domains.split(","),e.profanity_triggered_moderation.count=parseInt(e.profanity_triggered_moderation.count),e.profanity_triggered_moderation.duration=parseInt(60*e.profanity_triggered_moderation.duration),console.log(e),Ce({token:this.state.firebaseToken,settings:e})}}},{key:"componentWillReceiveProps",value:function(e,t){var n=this;e.user&&this.state.flag&&e.user.getIdToken().then(function(e){Ce({token:e}).then(function(t){switch(console.log(t),t.data.profanity_filter.type){case 0:t.data.profanity_filter.type="Do nothing";break;case 1:t.data.profanity_filter.type="Replace with asterisks";break;case 2:t.data.profanity_filter.type="Block messages"}switch(t.data.domain_filter.type){case 0:t.data.domain_filter.type="Do nothing";break;case 1:t.data.domain_filter.type="Allow only these domains";break;case 2:t.data.domain_filter.type="Block these domains"}switch(t.data.profanity_triggered_moderation.action){case 0:t.data.profanity_triggered_moderation.action="Do nothing";break;case 1:t.data.profanity_triggered_moderation.action="Mute user";break;case 2:t.data.profanity_triggered_moderation.action="Kick user from channel";break;case 3:t.data.profanity_triggered_moderation.action="Ban user from channel"}n.setState({sendbirdSettings:t.data,firebaseToken:e,flag:!1})})})}},{key:"render",value:function(){var e=this,t=this.state.sendbirdSettings,n=this.props.form.getFieldDecorator;return t?r.a.createElement(p.a,{style:{width:"100%"}},r.a.createElement(pe.a,Object.assign({},Me,{layout:"vertical",className:"login-form"}),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Allow new users to see previous messages in channels",colon:!1},n("display_past_message",{initialValue:t.display_past_message.toString()})(r.a.createElement(ve.a,{checkedChildren:"Yes",unCheckedChildren:"No",defaultChecked:t.display_past_message})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Allow links in chat messages"},n("allow_links",{initialValue:t.allow_links.toString()})(r.a.createElement(ve.a,{checkedChildren:"Yes",unCheckedChildren:"No",defaultChecked:t.allow_links})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Filtered keywords",help:'Specifies the comma-separated words to filter from chat messages. *word filters all words that end with "word" including "word" itself while word* filters all words that start with "word" including "word" itself.'},n("profanity_filter.keywords",{initialValue:t.profanity_filter.keywords})(r.a.createElement(b.a,{defaultValue:t.profanity_filter.keywords,placeholder:"*sex*, *profanity* ... "})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Keyword filter type"},n("profanity_filter.type",{initialValue:t.profanity_filter.type})(r.a.createElement(he.a,{firstActiveValue:t.profanity_filter.type},r.a.createElement(we,{value:"Do nothing"},"Do nothing"),r.a.createElement(we,{value:"Replace with asterisks"},"Replace with asterisks"),r.a.createElement(we,{value:"Block messages"},"Block messages"))))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Filtered domains",help:"Specifies an list of domains to filter from chat messages. Each item of the list should be specified at least with a combination of domain name and TLD (top level domain) like 'amazon.com'."},n("domain_filter.domains",{initialValue:t.domain_filter.domains.toString()})(r.a.createElement(b.a,{defaultValue:t.domain_filter.domains,placeholder:"amazon.com, google.com ..."})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Domain filter type"},n("domain_filter.type",{initialValue:t.domain_filter.type})(r.a.createElement(he.a,{firstActiveValue:t.domain_filter.type},r.a.createElement(we,{value:"Do nothing"},"Do nothing"),r.a.createElement(we,{value:"Allow only these domains"},"Allow only these domains"),r.a.createElement(we,{value:"Block these domains"},"Block these domains"))))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Automated profanity moderation count",help:"Number of infractions before a user is automatically punished. A value of 0 turns off automated moderation."},n("profanity_triggered_moderation.count",{initialValue:t.profanity_triggered_moderation.count.toString()})(r.a.createElement(b.a,{defaultValue:t.profanity_triggered_moderation.count.toString()})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Automated profanity moderation duration",help:"Minutes before previous infractions are forgotten. If count above is two and the duration is five, then the user will be punished if they commit two infractions within five minutes."},n("profanity_triggered_moderation.duration",{initialValue:t.profanity_triggered_moderation.duration/60})(r.a.createElement(b.a,{defaultValue:t.profanity_triggered_moderation.duration/60})))),r.a.createElement(p.a,{className:"settings_container"},r.a.createElement(pe.a.Item,{label:"Automated profanity moderation severity",help:"Action to perform when a user commits enough infractions during the specified duration."},n("profanity_triggered_moderation.action",{initialValue:t.profanity_triggered_moderation.action})(r.a.createElement(he.a,{firstActiveValue:t.profanity_triggered_moderation.action},r.a.createElement(we,{value:"Do nothing"},"Do nothing"),r.a.createElement(we,{value:"Mute user"},"Mute user"),r.a.createElement(we,{value:"Kick user from channel"},"Kick user from channel"),r.a.createElement(we,{value:"Ban user from channel"},"Ban user from channel"))))),r.a.createElement(p.a,{className:"settings_container",style:{whiteSpace:"nowrap"}},r.a.createElement(g.a,{style:{marginRight:10},onClick:function(){e.props.form&&e.props.form.resetFields()}},"Reset"),r.a.createElement(g.a,{type:"primary",onClick:function(){return e.handleSettingsSubmit()}},"Submit"))),r.a.createElement("style",null,"\n    .settings_container {\n        float: right;\n        width: 100%;\n    }\n")):r.a.createElement("div",null)}}]),t}(a.Component)),Se=pe.a.create({name:"settings_form"})(xe),Ne=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(h.a,{exact:!0,path:"/",component:S}),r.a.createElement(h.a,{path:"/dashboard",component:G}),r.a.createElement(h.a,{path:"/channels",component:me}),r.a.createElement(h.a,{path:"/users",component:Ee}),r.a.createElement(h.a,{path:"/settings",component:Se})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(Ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[280,1,2]]]);
//# sourceMappingURL=main.f45211c7.chunk.js.map